\documentclass[12pt]{article}

\usepackage{german}
\usepackage{geometry}
\usepackage[onehalfspacing]{setspace}

\geometry{
    left=3cm,
    right=3cm,
    top=2.5cm,
    bottom=2.5cm
}

\usepackage{listings}
\usepackage{xcolor}

\usepackage{amsmath}

\lstset{
    tabsize = 4, %% set tab space width
    showstringspaces = false, %% prevent space marking in strings, string is defined as the text that is generally printed directly to the console
    numbers = left, %% display line numbers on the left
    commentstyle = \color{green}, %% set comment color
    keywordstyle = \color{blue}, %% set keyword color
    stringstyle = \color{red}, %% set string color
    rulecolor = \color{black}, %% set frame color to avoid being affected by text color
    basicstyle = \small \ttfamily , %% set listing font and size
    breaklines = true, %% enable line breaking
    numberstyle = \tiny,
}

\title{Numerisches finden von Nullstellen - Implementierung in Java}
\author{Jakob Rzeppa}

\begin{document}
\begin{titlepage}
	\centering
    {\huge IGSFF LOGO TODO\par}
	{Grünewaldstraße 12a - 38104 Braunschweig - T. 470 5850\par}
	\vspace{1cm}
	{\underline{Seminarfach:}\par}
	\vspace{1cm}
    {\large Facharbeit des Schülers \textit{Jakob Rzeppa} \par mit dem Thema: \par}
    \vspace{1.5cm}
	{\huge Numerisches finden von Nullstellen - Implementierung in Java\par}
	\vspace{2cm}
\end{titlepage}

\tableofcontents

\section{Einleitung}

\subsection{Problemstellung}

\subsection{Verwendungszwecke}


\section{Durand-Kerner-Methode}
Die Durand-Kerner-Methode, auch genannt Weierstrass-Methode, ist ein iteratives Verfahren, zur numerischen Bestimmung aller komplexen Nullstellen einer univariaten Polynomfunktion.
Sie wurde von Karl Weierstrass zwischen 1859 und 1891, als Teil seines Beweises des Fundermentalsatz der Algebra, entwickelt und 1960 von Durand sowie 1966 von Immo Kerner unabhängig voneinander wiederentwickelt.
Die Durand-Kerner-Methode findet die Nullstellen, im Gegensatz zum Newton-Horner-Verfahren\footnote{
    Das Newton-Horner-Verfahren ist eine Kombination der Newton-Methode und des Horner-Schemas. Dabei wird eine Nullstelle mithilfe der Newton-Methode gefunden und dannach mithilfe des Horner-Schemas von der Funktion entfernt. Das Verfahren wird bis alle Nullstellen gefunden wurden wiederholt.
}
, nicht nacheinander, sondern parallel. Das bedeutet, dass bei jedem Schritt jede Nullstelle genauer wird und nicht jede Nullstelle nacheinander approximiert wird.\footnote{

}

%----------------------------------------------------------------------------------------------------
\section{Funktionsweise}
\subsection{Bedingungen}
Für die Durand-Kerner-Methode muss ein normiertes univariates Polynom der Form $f(x) = x^n + a_{n-1} x^{n-1} + \dots + a_1 x + a_0$ gegeben sein. Der Grad $n$ des Polynoms muss größer als zwei sein.

\subsection{Methode}
Bei der Durand-Kerner-Methode wird mit jeder Iteration jede Nullstelle etwas genauer. Dafür werden $n$ Gleichungen für $n$ Nullstellen $\xi_n;\xi_{n-1};\dots;\xi_1$ gebildet. Über diese wird, bis das Endkriterium erreicht ist, iteriert. Dabei ist $i$ die Anzahl der Iterationen und wird pro Iteration um 1 inkrementiert.
\[\xi_n^{(i+1)} = x - \frac{f(\xi_n^{(i)})}{\prod_{j=1;j\neq n}^{n}(\xi_n^{(i)}-\xi_j)}\]
\[\xi_{n-1}^{(i+1)} = x - \frac{f(\xi_{n-1}^{(i)})}{\prod_{j=1;j\neq n-1}^{n}(\xi_{n-1}^{(i)}-\xi_j)}\]
\vspace{0.25mm}
\[\dots\]
\[\xi_{1}^{(i+1)} = x - \frac{f(\xi_{1}^{(i)})}{\prod_{j=1;j\neq 1}^{n}(\xi_{1}^{(i)}-\xi_j)}\]
\subsection{Startpunkte}
Zunächst müssen alle Startpunkte $\xi_n^{(0)};\xi_{n-1}^{(0)};\dots;\xi_1^{(0)}$ gesetzt werden. Das kann zufällig passieren. Es muss jedoch beachtet werden, dass Startpunkte für komplex Nullstellen auch komplex sind und keine konjugierten Paare\footnote{Konjugierte Paare sind Paare von komplexen Zahlen, welche sich nur im Vorzeichen des imaginären Teils unterscheiden. !!!FUßNOTE!!!} vorkommen. Die Startpunkte können allerdings die Anzahl der Iterationen beeinflussen. Deswegen macht es Sinn möglichst nahe an den wahrscheinlichen Nullstellen anzufangen. Eine der gänigsten Methoden ist die Startpunkte in einem Kreis auf der komplexen Ebene zu verteilen. Dabei ist der Radius $r = \sqrt[n]{|a_0|}$ relativ genau. Jedoch ist es sehr ressourcenintensiv mit einem Computer Wurzeln zu berechnen. Deshalb kann auch ein weniger genaueres $r$ genommen werden: $r = |\frac{na_0}{2a_1}| + |\frac{a_{n-1}}{2n}|$.
Das Inkrement $\theta = \frac{2\pi}{n} \text{ bzw. } \frac{360^\circ}{n}$. Mit diesem werden alle Startpunkte gleichmäßig verteilt, indem der Kreis in $n$ Abschnitte geteilt wird, an dessen Anfängen die Startpunkte liegen. Zuletzt wird noch eine Verschiebung $c$ benötigt. Diese kann beliebig gewählt werden, solange keine reellen Zahlen unter den Startpunkten sind. In diesem Fall wird $c = \frac{\pi}{2n}$ gewählt.
Um die Startpunkte zu bestimmen wird 
\[\xi_{k}^{(0)} = r\cos((k-1)\theta+c)+r\sin((k-1)\theta+c)i \text{ für } k=1;2;\dots;n\]
 angewand.

\subsection{Endkriterium}
Um zu bestimmen, ob eine Nullstelle gefunden wurde gibt es zwei oft verwendete Verfahren. Einmal das einsetzen in die Funktion und 

%-----------------------------------------------------------------------------------------------------------
\section{Beispiel}
Im nächsten Abschnitt wird die Durand-Kerner-Methode an einer Polynomfunktion vierten Grades beispielhaft durchgeführt. Dabei wird die Genauigkeit im Beispiel auf vier Nachkommastellen begrenzt, was zu Ungenauigkeiten kleiner als $0,0001$ führen kann.
\paragraph{Methode}
Für die Funktion $f(x) = x^4 + 4x^3 - 2x^2 + 3x - 4 = (x-s)(x-t)(x-u)(x-v)$ sind die Nullstellen $s;t;u;v \in C$ gesucht. Auf jede der Nullstellen wird die zuvor beschriebene Methode angewendet:
\begin{displaymath}
    s_{n+1} = s_n-\frac{f(s_n)}{(s_n-t_n)(s_n-u_n)(s_n-v_n)}
\end{displaymath}
\begin{displaymath}
    t_{n+1} = t_n-\frac{f(t_n)}{(t_n-s_n)(t_n-u_n)(t_n-v_n)}
\end{displaymath}
\begin{displaymath}
    u_{n+1} = u_n-\frac{f(u_n)}{(u_n-s_n)(u_n-t_n)(u_n-v_n)}
\end{displaymath}
\begin{displaymath}
    v_{n+1} = v_n-\frac{f(v_n)}{(v_n-s_n)(v_n-t_n)(v_n-u_n)}
\end{displaymath}
\paragraph{Startpunkte}
Zuvor müssen allerdings die Startpunkte $s_0;t_0;u_0;v_0$ bestimmt werden. Dabei ist der Radius des Kreises $r = |\frac{na_0}{2a_1}| + |\frac{a_{n-1}}{2na_n}| = \frac{19}{6}$, der Abstand zwischen den Startpunkten $\theta = \frac{2\pi}{n} = \frac{1}{2}\pi$ und die Verschiebung $c = \frac{\pi}{2n} = \frac{1}{8}\pi$. Mit diesen Werten können die Startpunkte berechnet werden. \\
$s_0 = r \cos(c) + r \sin(c)i = 2,9256 + 1,2118i$ \\
$t_0 = r \cos(\theta+c) + r \sin(\theta+c)i = -1,2118 + 2,9256i$ \\
$u_0 = r \cos(2\theta+c) + r \sin(2\theta+c)i = -2,9256 - 1,2118i$ \\
$v_0 = r \cos(3\theta+c) + r \sin(3\theta+c)i = 1,2118 - 2,9256i$

\paragraph{Ausführung}
\begin{center}
\begin{tabular}{c|c c c c}
    Iteration & r & s & t & u \\
    \hline
    0 & 2,9256 + 1,2118i & -1,2118 + 2,9256i & -2,9256 - 1,2118i & 1,2118 - 2,9256i \\
    1 & 1,2993 + 0,8722i & -1,8873 + 2,0075i & -3,405 - 0,7665i & -0,0069 - 2,1133i \\
    2 & 1,0806 + 0,5889i & -1,1784 + 0,4767i & -4,1287 + 0,3433i & 0,2265 - 1,4089 \\
    3 & 0,7884 + 0,3817i & -0,2138 + 0,7292i & -4,6806 - 0,0989 & 0,1061 - 1,012i \\
    4 & 0,6759 - 0,234i & 0,0243 + 0,9804i & -4,613 - 0,0021i & -0,0872 - 0,9549i \\
    5 & 0,8621 + 0,0197i & -0,1294 + 0,9945i & -4,6149 & -0,1177 - 1,0141i \\
    6 & 0,842 + 0,0004i & -0,1134 + 1,0078i & -4,6149 & -0,1136 - 1,0082i \\
    7 & 0,8421 & -0,1136 + 1,0081i & -4,6149 & -0,1136 - 1,0081 \\
    8 & 0,8421 & -0,1136 + 1,0081i & -4,6149 & -0,1136 - 1,0081 \\
\end{tabular}
\end{center}
\paragraph{Schluss}
Zwischen Iteration acht und neun bleiben die Werte gleich. Damit ist das Endkriterium erreicht und die Durand-Kerner-Meethod abgeschlossen. Die Nullstellen der Polynomfunktion $f(x) = x^4 + 4x^3 - 2x^2 + 3x - 4$ sind bei ca. $0,8421; -4,6149; -0,1136 - 1,0081i; -0,1136 + 1,0081$. 
\paragraph{Probe}
Zur Überpfüfung kann jeder der Werte in $f(x)$ eingesetzt werden.
\begin{displaymath}
    f(0,8421) \approx 0; f(-4,6149) \approx 0; f(-0,1136 - 1,0081i) \approx 0; f(-0,1136 + 1,0081i) \approx 0
\end{displaymath}
Daraus kann geschlossen werden, dass alle vier Werte Annährungen der Nullstellen der Polynomfunktion $f(x)$ sind. \\
Weiterhin, kann aus dem Fundermentalsatz der Algebra hergeleitet werden, dass alle Nullstellen von $f(x)$ gefunden wurden, da $n$ gleich der Anzahl der gefunden Nullstellen ist. \\
Die Durand-Kerner-Methode war für $f(x)$ erfolgreich.

\section{Visualisierung}

\section{Herleitung}
\subsection{Methode}
Die Durand-Kerner-Methode baut auf der Newton-Methode auf. Es wird für den Zähler des Bruches, statt der Ableitung der Funktion, eine beliebige Funktion genommen, indem man so tut, als wüsste man die Nullstellen der Funktion. Wenn dies für alle Nullstellen parallel durchgeführt wird kommt man den Nullstellen immer näher und auch die anfangs zufällige Funktion kommt immer näher an die eigendliche Funktion ran.

Ähnlichkeiten mit der Newton-Methode
ableitung =? funktion

Man tut so als wüsste man die anderen Nullstellen und sucht mit diesen infos eine andere

Weierstraß-Korrekturen

Wenn man die Durand-Kerner-Methode für die Nullstelle $r$ anguckt kann man ein wenig umstellen:
\begin{displaymath}
    z := \xi_k
\end{displaymath}
\begin{displaymath}
    z_{i+1} = z_i - \frac{f(z_i)}{\prod_{j=1;j\neq k}^n (z_i-\xi_j)}
\end{displaymath}
\begin{displaymath}
    z_{i+1} = z_i - \frac{\prod_{j=1}^n (z_i-\xi_j^i)}{\prod_{j=1;j\neq k}^n (z_i-\xi_j)}
\end{displaymath}
\begin{displaymath}
    z_{i+1} = z_i - \frac{\prod_{j=1}^n (z_i-\xi_j)}{\prod_{j=1;j\neq k}^n (z_i-\xi_j)}
\end{displaymath}

Sei $f(x) = x^n + a_{n-1} x^{n-1} + ... + a_1 x + a_0$ ein Polynom mit komplexen Koeffizienten und führendem Koeffizienten $a_n = 1$. Nach dem Fundermentalsatz der Algebra hat $f(x)$ genau $n$ Nullstellen $\xi_n;\xi_{n-1};...;\xi_1 \in C$ hat und in Linearfaktoren zerlegt werden kann. Daraus folgt $f(x) = (x - \xi_n)(x - \xi_{n-1})...(x - \xi_1)$. Nun kann für $\xi_n$ umgestellt werden:
\begin{displaymath}
    (x - \xi_n)(x - \xi_{n-1})...(x - \xi_1) = f(x)
\end{displaymath}
\begin{displaymath}
    \frac{(x - \xi_n)(x - \xi_{n-1})...(x - \xi_1)}{(x - \xi_{n-1})...(x - \xi_1)} = \frac{f(x)}{(x - \xi_{n-1})...(x - \xi_1)}
\end{displaymath}
\begin{displaymath}
    x - \xi_n = \frac{f(x)}{(x - \xi_{n-1})...(x - \xi_1)}
\end{displaymath}
\begin{displaymath}
    - \xi_n = - x + \frac{f(x)}{(x - \xi_{n-1})...(x - \xi_1)}
\end{displaymath}
\begin{displaymath}
    \xi_n = x - \frac{f(x)}{(x - \xi_{n-1})...(x - \xi_1)}
\end{displaymath}

\subsection{Startpunkte}

\subsection{Endkriterium}
Welches der zwei verfahren beesser ist

\section{Probleme und Einschränkungen}
\subsection{Normiertes Polynom}
Für die Durand-Kerner-Methode muss die gegebene Funktion $f(x)$ in der Form $\prod_{i=1}^n (x-\xi_i)$ dargestellt werden können. Da $\prod_{i=1}^n (x-\xi_i)$ ausmultipliziert, in jedem Fall ein normiertes Polynom ergibt, muss $f(x)$ für die Durand-Kerner-Methode ein normiertes Polynom sein.
Ist dies nicht der Fall, wird es unmöglich, $f(x)$ in der Form $\prod_{i=1}^n (x-\xi_i)$ darzustellen. Daraus folgt, dass man die Methode ohne Umwege nicht ausführen kann. \\
Allerdings gibt es eine einfache Lösung für dieses Problem. Wenn man eine Funktion gleich null setzt, kann man beide Seiten mit einer beliebigen Zahl multiplizieren. Dabei verändert sich das Ergebnis nicht, da $0m = 0$ \space $\forall m$ ist. Daraus folgt, dass sich die Nullstellen eines Polynoms, wenn dieses mit einer beliebigen Zahl multipliziert wird, nicht verändern. \\
Somit kann man das Polynom, dessen Nullstellen man finden möchte, durch $a_n$ teilen und bekommt ein normiertes Polynom mit den gleichen Nullstellen. Mit diesem kann man dann die Durand-Kerner-Methode durchführen.

\subsection{Keine generelle Konvergenz}
Die Durand-Kerner-Methode ist nicht generell Konvergent. Das bedeutet, dass in manchen Fällen die Funktion gegen Unendlich keinen festen Wert anstrebt. Dabei kann nicht genau bestimmt werden, bei welchen Startpunkten und Polynomen die Durand-Kerner-Methode nicht konvergiert. Da dies allerdings sehr selten ist kann es meist vernachlässigt werden.

\section{Implementierung}
\subsection{Einleitung}
Normierung
\subsection{Komplexe Zahlen}
Wieso?

\subsubsection{Aufbau der Klasse}
Eine komplexe Zahl besteht aus einem reelen Teil und einem imaginären Teil. Deswegen hat die Klasse Complex die Attribute re (reeler Teil) und im (imaginärer Teil). 
(vgl. Complex.java, Z. 4-5)

Zuerst werden die Standartoperationen Addition, Subtraktion, Multiplikation und Division behandelt. Dabei sind alle der Methoden statisch, nehmen zwei komplexe Zahlen entgegen und geben das Ergebnis als neue komplexe Zahl zurück. Darauffolgend wird auf die Operationen Potenzierung, Multiplikation mehr als zwei Zahlen und Finden des Betrags bzw. absoluten Wertes. 

\paragraph{Addition und Subtraktion}
\begin{lstlisting}[language=Java, title={Complex.java: Z. 19-29}]
public static Complex plus(Complex a, Complex b) {
        double re = a.re + b.re;
        double im = a.im + b.im;
    return new Complex(re, im);
}

public static Complex minus(Complex a, Complex b) {
    double re = a.re - b.re;
    double im = a.im - b.im;
    return new Complex(re, im);
}
\end{lstlisting}


\paragraph{Multiplikation}
\begin{displaymath}
    (a+bi)(c+di) = ac+adi+cbi-bdi^2 = ac-bd+(ad+cb)i
\end{displaymath}
\paragraph{Division}
\paragraph{Exponentiation?}
\paragraph{Kleiner Als}


    \subparagraph{abs}

    \paragraph{Ausgabe}
    \subparagraph{toString-Methode}
    \subparagraph{runden}

    
    \subsubsection{Polynomfunktionen}
    \subsubsection{Durand-Kerner für eine Nullstellen}
    \subsubsection{Startpunkte}
    \subsubsection{Durnad-Kerner für alle Nullstellen}
    \subsubsection{Endbedingungen}
    \subsubsection{Testen}

\section{Vergleich und Anwendung}

\section{Fazit}

\section{Code}

\end{document}